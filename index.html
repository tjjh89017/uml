<html>
<head>
	<link rel="stylesheet" type="text/css" href="joint.css" />
	<script src="jquery.min.js"></script>
	<script src="lodash.min.js"></script>
	<script src="backbone-min.js"></script>
	<script src="joint.js"></script>
</head>

<body>
	<!-- layout -->
	<div id="select-menu">
		<button id='select' class='button' disabled>Select</button>
		<button id='create-class' class='button'>Create Class</button>
		<button class='button'>c</button>
		<button class='button'>d</button>
		<button class='button'>e</button>

	</div>
    <div id="myholder" style="border-style:solid;width:1000px;height:600px"></div>





    <!-- code -->
    <script type="text/javascript">

	    var graph = new joint.dia.Graph;

    	var paper = new joint.dia.Paper({
	    	el: $('#myholder'),
		    width: 1000,
    		height: 1000,
			model: graph,
			gridSize: 1
		});

		var rect = new joint.shapes.basic.Rect({
			position: { x: 100, y: 30 },
			size: { width: 100, height: 30 },
			attrs: { rect: { fill: 'blue' }, text: { text: 'my box', fill: 'white' } }
		});

		var rect2 = rect.clone();
		rect2.translate(300);

		var link = new joint.dia.Link({
			source: { id: rect.id },
			target: { id: rect2.id }
		});

		$('#create-class').click(function(event){
			console.log('create-class onclick');
			paper.on('blank:pointerclick', function(event, x1, y1){
				//paper.off('blank:pointerclick');
				graph.addCells([new joint.shapes.basic.Rect({
					position: {x: x1, y: y1},
					size: {width: 100, height: 30},
					attrs: {rect: {fill: 'blue'}, text: {text: 'mybox', fill: 'white'}}
				})]);
			});
			$('button').attr('disabled', false);
			$('#create-class').attr('disabled', true)
		});

		$('#select').click(function(event){
			console.log('select onclick');
			paper.off('blank:pointerclick');
			$('button').attr('disabled', false);
			$('#select').attr('disabled', true);
		});

		paper.on('cell:pointerclick', function(cellView, event, x, y){
			
			if(cellView.$el.attr('class').indexOf('highlighted') > -1){
				cellView.unhighlight();
			}
			else{
				cellView.highlight();
			}
			console.log(cellView);
			console.log(cellView.$el.attr('class'));
		});

		graph.addCells([rect, rect2, link]);

  	</script>
</body>
</html>